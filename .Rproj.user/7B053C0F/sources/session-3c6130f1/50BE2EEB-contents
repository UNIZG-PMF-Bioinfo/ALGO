# Install if necessary
if (!requireNamespace("GEOquery", quietly = TRUE)) 
  install.packages("GEOquery")

library(GEOquery)

# Download metadata (GSE130970)
gse <- getGEO("GSE123658", GSEMatrix = TRUE)

# Extract phenotype / sample metadata
pheno <- pData(gse[[1]])

# View metadata
head(pheno)
setDT(pheno)

pheno[,.N, `age:ch1`] %>% 
  ggplot(., aes(y=N, x=`age:ch1`)) +
  geom_col(fill="magenta4") +
  theme_bw()
